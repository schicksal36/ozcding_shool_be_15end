# app/schemas/diary.py

from pydantic import BaseModel, Field
from datetime import datetime


# ==================================================================
# ğŸ”¥ DiaryCreate â€” ë‹¤ì´ì–´ë¦¬ ìƒì„± ìš”ì²­ ì „ìš© ìŠ¤í‚¤ë§ˆ
# ------------------------------------------------------------------
# í´ë¼ì´ì–¸íŠ¸ê°€ POST /diaries ì— ì „ë‹¬í•˜ëŠ” JSONì„ ê²€ì¦í•˜ëŠ” ëª¨ë¸
# ì˜ˆ:
#   {
#       "title": "ì˜¤ëŠ˜ì˜ ì¼ê¸°",
#       "content": "ì˜¤ëŠ˜ì€ FastAPI ê³µë¶€ë¥¼ í–ˆë‹¤."
#   }
# ==================================================================
class DiaryCreate(BaseModel):
    title: str = Field(..., min_length=1)
    """
    Field(...):
        - í•„ìˆ˜(required) ê°’ì´ë¼ëŠ” ì˜ë¯¸
    min_length=1:
        - ì œëª©ì´ ë¹ˆ ë¬¸ìì—´ì´ë©´ ìš”ì²­ ì‹¤íŒ¨(422)
    """

    content: str
    """
    ë‚´ìš©ì€ í•„ìˆ˜ í•„ë“œ(Required)
    ë³„ë„ì˜ length ì œí•œì€ ì—†ìŒ
    """


# ==================================================================
# ğŸ”¥ DiaryUpdate â€” ë¶€ë¶„ ìˆ˜ì • PATCH / PUT ìš”ì²­ìš© ìŠ¤í‚¤ë§ˆ
# ------------------------------------------------------------------
# titleê³¼ content ëª¨ë‘ ì˜µì…˜(optional) â†’ ë¶€ë¶„ ì—…ë°ì´íŠ¸ ê°€ëŠ¥
# ì˜ˆ:
#   {
#       "title": "ìˆ˜ì •ëœ ì œëª©"
#   }
#
# ì´ ìŠ¤í‚¤ë§ˆëŠ” PUT ìš”ì²­ì—ì„œë„ ìœ ì—°í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥.
# Service ê³„ì¸µì—ì„œ None ì—¬ë¶€ë¥¼ ê²€ì‚¬í•´ í•„ìš”í•œ í•„ë“œë§Œ ìˆ˜ì •.
# ==================================================================
class DiaryUpdate(BaseModel):
    title: str | None = None
    content: str | None = None

    """
    title=None ë˜ëŠ” content=None ìœ¼ë¡œ ì „ë‹¬ë˜ë©´ í•´ë‹¹ í•„ë“œëŠ” ìˆ˜ì •ë˜ì§€ ì•ŠìŒ.
    """


# ==================================================================
# ğŸ”¥ DiaryResponse â€” API ì‘ë‹µìš© ìŠ¤í‚¤ë§ˆ (ì¶œë ¥ìš© DTO)
# ------------------------------------------------------------------
# ORM ëª¨ë¸(Diary) â†’ Pydantic ëª¨ë¸(DiaryResponse) ë³€í™˜ìš©
# FastAPIê°€ ë¦¬í„´í•˜ëŠ” ê°ì²´ë¥¼ ìë™ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì—­í• ì„ í•¨.
# ==================================================================
class DiaryResponse(BaseModel):
    id: int
    title: str
    content: str
    created_at: datetime
    user_id: int
    """
    user_id:
        Userì™€ DiaryëŠ” FK ê´€ê³„ì´ë¯€ë¡œ ORM ê°ì²´ì—ì„œ ìë™ìœ¼ë¡œ ì¶”ì¶œë¨.
    """

    # --------------------------------------------------------------
    # ğŸ”¥ Pydantic v2 ë°©ì‹: ORM ê°ì²´ë¥¼ ìë™ ë³€í™˜í•˜ë„ë¡ í—ˆìš©
    # --------------------------------------------------------------
    class Config:
        from_attributes = True
        """
        Pydantic v1ì˜ orm_mode = True ì™€ ë™ì¼í•œ ê¸°ëŠ¥.

        FastAPI ë™ì‘ ì›ë¦¬:
            return diary (Tortoise ëª¨ë¸)
                â†“
            FastAPIê°€ DiaryResponse.model_validate(diary) í˜¸ì¶œ
                â†“
            from_attributes=True ë•ë¶„ì— ORM ê°ì²´ì˜ attributeë¥¼ ì½ì–´ ë³€í™˜ ì„±ê³µ

        ì¦‰, Tortoise ëª¨ë¸ì„ ì§ì ‘ JSONìœ¼ë¡œ ì‘ë‹µí•  ìˆ˜ ìˆê²Œ ë¨.
        """

